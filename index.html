<!DOCTYPE html>
<html lang="es" id="html-root">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpelLike - Roguelike</title>
    <meta name="description" content="Un roguelike infinito donde combinas runas para crear builds devastadores mientras conquistas mazmorras procedurales.">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="stylesheet" href="css/meta_upgrades.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <!-- TRANSLATION SYSTEM - Load First! -->
    <script src="js/translations.js?v=13"></script>
</head>

<body>
    <!-- Main Menu Screen -->
    <div id="main-menu" class="screen active">
        <div class="menu-background"></div>
        <div class="menu-content">
            <div class="logo-container">
                <div class="logo-icon"><img src="assets/logo_s.png" alt="SpelLike" class="logo-icon-img"></div>
                <h1 class="game-title" data-i18n="gameTitle">SpelLike</h1>
                <p class="tagline" data-i18n="tagline">Combina. Conquista. Repite hasta morir.</p>
            </div>
            <div class="menu-buttons">
                <button class="menu-btn" id="btn-play">
                    <span class="btn-icon">‚ñ∂</span> <span data-i18n="btnPlay">INICIAR PARTIDA</span>
                </button>
                <button class="menu-btn" id="btn-meta">
                    <span class="btn-icon">‚ú®</span> <span data-i18n="btnMeta">MEJORAS</span>
                </button>
                <button class="menu-btn" id="btn-settings">
                    <span class="btn-icon">‚öô</span> <span data-i18n="btnSettings">AJUSTES</span>
                </button>
                <button class="menu-btn" id="btn-feedback">
                    <span class="btn-icon">üí¨</span> <span data-i18n="btnFeedback">FEEDBACK</span>
                </button>
                <button class="menu-btn" id="btn-quit">
                    <span class="btn-icon">üö™</span> <span data-i18n="btnQuit">SALIR</span>
                </button>
                <button class="menu-btn" id="btn-updates">
                    <span class="btn-icon">üìù</span> <span data-i18n="btnUpdates">NOVEDADES</span>
                </button>
            </div>
            <div id="audio-unlock-hint" class="audio-hint" data-i18n-html="audioHint">
                üîä Activar m√∫sica: hac√© <b>click</b> o presion√° <b>una tecla</b>.
            </div>
            <div id="meta-essence" class="meta-essence-inline"><span data-i18n="metaEssence">Esencia</span>: <span id="essence-amount">0</span></div>
            <div class="version" data-i18n="version">v0.1.3 Early Access</div>
        </div>
    </div>

    <!-- Meta Upgrades Screen -->
    <div id="meta-screen" class="screen">
        <div class="menu-background"></div>
        <div class="screen-header">
            <h2 data-i18n="metaTitle">‚ú® MEJORAS PERMANENTES</h2>
            <div id="meta-screen-essence" class="meta-essence"><span data-i18n="metaEssence">Esencia</span>: <span id="meta-essence-amount">0</span></div>
        </div>
        <div id="meta-shop-list" class="meta-shop-list"></div>
        <div class="screen-footer">
            <button id="btn-meta-back" class="menu-btn small" data-i18n="btnBack">VOLVER</button>
        </div>
    </div>

    <!-- Updates Screen -->
    
    <div id="updates-screen" class="screen hidden">
      <div class="menu-background"></div>
      <div class="screen-header">
        <h2 class="menu-title" data-i18n="updatesTitle">UPDATES</h2>
      </div>

      <div class="updates-list">
        <div class="update-entry">
          <h3 data-i18n="updatesVersion013">v0.1.3 - Early Access</h3>
          <pre id="updates-notes-013" class="update-notes"></pre>
        </div>

        <div class="update-entry">
          <h3 data-i18n="updatesVersion012">v0.1.2 - Early Access</h3>
          <pre id="updates-notes-012" class="update-notes"></pre>
        </div>

        <div class="update-entry">
          <h3 data-i18n="updatesVersion011">v0.1.1 - Early Access</h3>
          <pre id="updates-notes-011" class="update-notes"></pre>
        </div>
      </div>

      <div class="screen-footer">
        <button class="menu-btn back-btn" id="btn-back-updates" data-i18n="btnBack">‚Üê VOLVER</button>
      </div>
    </div>

<div id="feedback-screen" class="screen">
        <div class="screen-header">
            <h2 data-i18n="feedbackTitle">üí¨ FEEDBACK</h2>
        </div>
        <div class="feedback-content">
            <p class="feedback-hint" data-i18n="feedbackHint">Us√° esto para reportar bugs o tirar ideas. Pod√©s copiar el texto y pegarlo en el chat.</p>

            <div class="feedback-row">
                <label for="feedback-type" data-i18n="feedbackType">Tipo</label>
                <select id="feedback-type">
                    <option value="bug" data-i18n="feedbackBug">Bug</option>
                    <option value="suggestion" data-i18n="feedbackSuggestion">Recomendaci√≥n</option>
                    <option value="balance" data-i18n="feedbackBalance">Balance</option>
                    <option value="other" data-i18n="feedbackOther">Otro</option>
                </select>
            </div>

            <div class="feedback-row">
                <label for="feedback-text" data-i18n="feedbackDetail">Detalle</label>
                <textarea id="feedback-text" rows="8" data-i18n-placeholder="feedbackPlaceholder"></textarea>
            </div>

            <div class="feedback-actions">
                <button class="menu-btn" id="btn-feedback-send"><span class="btn-icon">‚úâ</span> <span data-i18n="btnSend">ENVIAR</span></button>
                <button class="menu-btn" id="btn-feedback-copy"><span class="btn-icon">üìã</span> <span data-i18n="btnCopy">COPIAR</span></button>
                <button class="menu-btn" id="btn-feedback-clear"><span class="btn-icon">üßΩ</span> <span data-i18n="btnClear">LIMPIAR</span></button>
            </div>
            <p class="feedback-mailhint" data-i18n="feedbackMailHint">Si tiene fotos o videos por favor adjuntelos via LINK en el mensaje.</p>
            <div id="feedback-toast" class="feedback-toast" aria-live="polite"></div>
        </div>
        <button class="back-btn" id="btn-back-feedback" data-i18n="btnBack">‚Üê VOLVER</button>
    </div>

    <!-- Slot Selection Screen -->
    <div id="slot-select" class="screen">
        <div class="screen-header">
            <h2 data-i18n="slotSelectTitle">SELECCIONAR PARTIDA</h2>
        </div>
        <div class="slots-container" id="slots-container">
            <!-- Slots will be generated by JS -->
        </div>
        <button class="back-btn" id="btn-back-slots" data-i18n="btnBack">‚Üê VOLVER</button>
    </div>

    <!-- Difficulty Selection Screen -->
    <div id="difficulty-select" class="screen">
        <div class="screen-header">
            <h2 data-i18n="difficultyTitle">ELIGE TU DIFICULTAD</h2>
        </div>
        <div class="difficulty-options">
            <div class="difficulty-card" data-difficulty="normal">
                <div class="diff-icon">‚ö™</div>
                <h3 data-i18n="diffNormal">NORMAL</h3>
                <p data-i18n="diffNormalDesc">Experiencia est√°ndar. Recomendado para nuevos jugadores.</p>
                <ul>
                    <li data-i18n="diffNormalPoint1">‚úì Tutoriales activos</li>
                    <li data-i18n="diffNormalPoint2">‚úì Dificultad balanceada</li>
                </ul>
            </div>
            <div class="difficulty-card" data-difficulty="hard">
                <div class="diff-icon">üîµ</div>
                <h3 data-i18n="diffHard">DIF√çCIL</h3>
                <p data-i18n="diffHardDesc">Para jugadores experimentados. Mejor loot, m√°s riesgo.</p>
                <ul>
                    <li data-i18n="diffHardPoint1">‚Ä¢ Enemigos +50% HP</li>
                    <li data-i18n="diffHardPoint2">‚Ä¢ Enemigos +25% da√±o</li>
                    <li data-i18n="diffHardPoint3">‚Ä¢ Cofres +1 rareza</li>
                </ul>
                <div class="locked-overlay" data-i18n="diffHardLocked">üîí Derrota 1 jefe en Normal</div>
            </div>
            <div class="difficulty-card locked" data-difficulty="demonic">
                <div class="diff-icon">üî¥</div>
                <h3 data-i18n="diffDemonic">DEMENCIAL</h3>
                <p data-i18n="diffDemonicDesc">El verdadero desaf√≠o. Programa tu destino.</p>
                <ul>
                    <li data-i18n="diffDemonicPoint1">‚Ä¢ Enemigos +150% HP</li>
                    <li data-i18n="diffDemonicPoint2">‚Ä¢ Runas Vac√≠as + Forjas</li>
                    <li data-i18n="diffDemonicPoint3">‚Ä¢ Sin piedad</li>
                </ul>
                <div class="locked-overlay" data-i18n="diffDemonicLocked">üîí Derrota tu primer jefe</div>
            </div>
        </div>

        <div class="difficulty-bottom">
            <!-- Seed Input Container -->
            <div class="seed-input-container">
                <label for="seed-input" data-i18n="seedLabel">üé≤ Seed (opcional):</label>
                <div class="seed-controls">
                    <input type="text" id="seed-input" data-i18n-placeholder="seedPlaceholder" maxlength="16" autocomplete="off">
                    <button type="button" id="btn-random-seed" class="seed-btn" title="Generar seed random">üé≤</button>
                    <button type="button" id="btn-clear-seed" class="seed-btn" title="Limpiar">‚úñ</button>
                    <button type="button" id="btn-copy-seed" class="seed-btn" title="Copiar seed">üìã</button>
                </div>
            </div>

            <label class="difficulty-toggle">
                <input type="checkbox" id="opt-negative-events" checked>
                <span data-i18n="negativeEvents">Eventos negativos en salas</span>
            </label>

            <button class="menu-btn" id="btn-start-run" disabled>
                <span class="btn-icon">‚ñ∂</span> <span data-i18n="btnStart">INICIAR</span>
            </button>
        </div>
        <button class="back-btn" id="btn-back-diff" data-i18n="btnBack">‚Üê VOLVER</button>
    </div>

    <!-- Settings Screen -->
    <div id="settings-screen" class="screen">
        <div class="screen-header">
            <h2 data-i18n="settingsTitle">‚öô AJUSTES</h2>
        </div>
        <div class="settings-tabs">
            <button class="tab-btn active" data-tab="audio" data-i18n="tabAudio">üîä Audio</button>
            <button class="tab-btn" data-tab="graphics" data-i18n="tabGraphics">üñ• Gr√°ficos</button>
            <button class="tab-btn" data-tab="controls" data-i18n="tabControls">üéÆ Controles</button>
            <button class="tab-btn" data-tab="language" data-i18n="tabLanguage">üåê Idioma</button>
        </div>
        <div class="settings-content">
            <!-- Audio Settings -->
            <div class="settings-panel active" id="panel-audio">
                <div class="setting-item">
                    <label data-i18n="volMaster">Volumen Maestro</label>
                    <div class="slider-container">
                        <input type="range" id="vol-master" min="0" max="100" value="75">
                        <span class="slider-value">75%</span>
                    </div>
                </div>
                <div class="setting-item">
                    <label data-i18n="volMusic">M√∫sica</label>
                    <div class="slider-container">
                        <input type="range" id="vol-music" min="0" max="100" value="80">
                        <span class="slider-value">80%</span>
                    </div>
                </div>
                <div class="setting-item">
                    <label data-i18n="volSfx">Efectos de Sonido</label>
                    <div class="slider-container">
                        <input type="range" id="vol-sfx" min="0" max="100" value="70">
                        <span class="slider-value">70%</span>
                    </div>
                </div>
                <div class="setting-item">
                    <label data-i18n="volUi">UI / Interfaz</label>
                    <div class="slider-container">
                        <input type="range" id="vol-ui" min="0" max="100" value="80">
                        <span class="slider-value">80%</span>
                    </div>
                </div>
            </div>
            <!-- Graphics Settings -->
            <div class="settings-panel" id="panel-graphics">
                <div class="setting-item">
                    <label data-i18n="screenMode">Modo de Pantalla</label>
                    <div class="option-group">
                        <button class="option-btn" data-option="windowed" data-i18n="screenWindowed">Ventana</button>
                        <button class="option-btn active" data-option="fullscreen" data-i18n="screenFullscreen">Pantalla Completa</button>
                    </div>
                </div>
                <div class="setting-item">
                    <label data-i18n="pixelScaling">Escalado de Pixel</label>
                    <div class="option-group">
                        <button class="option-btn active" data-option="perfect" data-i18n="pixelPerfect">Pixel Perfect</button>
                        <button class="option-btn" data-option="stretched" data-i18n="pixelStretched">Estirado</button>
                    </div>
                </div>
                <div class="setting-item">
                    <label data-i18n="vfxQuality">Calidad de VFX</label>
                    <div class="option-group">
                        <button class="option-btn" data-option="low" data-i18n="vfxLow">Bajo</button>
                        <button class="option-btn" data-option="medium" data-i18n="vfxMedium">Medio</button>
                        <button class="option-btn active" data-option="high" data-i18n="vfxHigh">Alto</button>
                    </div>
                </div>
                <div class="setting-item checkbox-group">
                    <label><input type="checkbox" id="opt-screenshake" checked> <span data-i18n="optScreenshake">Screenshake</span></label>
                    <label><input type="checkbox" id="opt-particles" checked> <span data-i18n="optParticles">Part√≠culas</span></label>
                    <label><input type="checkbox" id="opt-hitflash" checked> <span data-i18n="optHitflash">Flash en Hit</span></label>
                </div>
                <div class="setting-item">
                    <label style="display: block; margin-bottom: 8px;" data-i18n="hudSynergies">Sinergias</label>
                    <div class="setting-row">
                        <label>
                            <input type="checkbox" id="setting-synergy-always-visible">
                            <span data-i18n="optSynergiesVisible">Sinergias siempre visibles</span>
                        </label>
                        <span class="setting-hint" data-i18n="optSynergiesHint">Mostrar panel de sinergias sin presionar B</span>
                    </div>
                </div>
            </div>
            <!-- Controls Settings -->
            <div class="settings-panel" id="panel-controls">
                <div class="controls-info">
                    <div class="control-item">
                        <span class="key">WASD</span>
                        <span data-i18n="ctrlMovement">Movimiento</span>
                    </div>
                    <div class="control-item">
                        <span class="key">Mouse</span>
                        <span data-i18n="ctrlAim">Apuntar</span>
                    </div>
                    <div class="control-item">
                        <span class="key">Click Izq</span>
                        <span data-i18n="ctrlShoot">Disparar</span>
                    </div>
                    <div class="control-item">
                        <span class="key">Espacio</span>
                        <span data-i18n="ctrlDash">Dash</span>
                    </div>
                    <div class="control-item">
                        <span class="key">E</span>
                        <span data-i18n="ctrlInteract">Interactuar</span>
                    </div>
                    <div class="control-item">
                        <span class="key">Q</span>
                        <span data-i18n="ctrlPotion">Usar Poci√≥n</span>
                    </div>
                    <div class="control-item">
                        <span class="key">F</span>
                        <span data-i18n="ctrlActive">Usar Activo</span>
                    </div>
                    <div class="control-item">
                        <span class="key">G</span>
                        <span data-i18n="ctrlActive2">Usar Activo 2 (si lo desbloqueas)</span>
                    </div>
                    <div class="control-item">
                        <span class="key">Tab</span>
                        <span data-i18n="ctrlInventory">Inventario</span>
                    </div>
                    <div class="control-item">
                        <span class="key">Esc</span>
                        <span data-i18n="ctrlPause">Pausa</span>
                    </div>
                </div>
            </div>
            <!-- Language Settings -->
            <div class="settings-panel" id="panel-language">
                <div class="language-selector">
                    <h3 data-i18n="tabLanguage">üåê Idioma / Language</h3>
                    <div class="language-options">
                        <button class="language-btn active" data-lang="es">
                            <span class="flag">üá¶üá∑</span>
                            <span data-i18n="langSpanish">Espa√±ol</span>
                        </button>
                        <button class="language-btn" data-lang="en">
                            <span class="flag">üá∫üá∏</span>
                            <span data-i18n="langEnglish">English</span>
                        </button>
                    </div>
                    <p class="language-hint" data-i18n="langRestart">Se recargar√° la p√°gina</p>
                </div>
            </div>
        </div>
        <div class="settings-buttons">
            <button class="action-btn" id="btn-apply-settings" data-i18n="btnApply">APLICAR</button>
            <button class="back-btn" id="btn-back-settings" data-i18n="btnBack">‚Üê VOLVER</button>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="game-screen" class="screen">
        <canvas id="game-canvas"></canvas>
        <div id="hud">
            <div id="game-ui">
                <div class="hud-section top-left">
                    <div class="vital-bar-container">
                        <span class="bar-label" data-i18n="hudLife">VIDA</span>
                        <div class="vital-bar health">
                            <div class="bar-fill" id="health-fill"></div>
                            <span class="bar-text" id="health-text">100/100</span>
                        </div>
                    </div>
                    <div class="vital-bar-container">
                        <span class="bar-label" data-i18n="hudMana">üíß MAN√Å</span>
                        <div class="vital-bar mana">
                            <div class="bar-fill" id="mana-fill"></div>
                            <span class="bar-text" id="mana-text">50/50</span>
                        </div>
                    </div>
                    <div class="biome-sala-info" id="biome-sala-info">
                        <div class="info-row">
                            <span><span data-i18n="hudBiome">Bioma</span>: <span id="biome-display">1/12</span></span>
                            <span><span data-i18n="hudRoom">Sala</span>: <span id="room-num-display">1/8</span></span>
                        </div>
                        <div class="event-row" id="event-row">
                            <span class="event-label" data-i18n="hudEvent">Evento:</span>
                            <span class="event-name" id="event-name" data-i18n="hudNone">Ninguno</span>
                        </div>
                        <div class="event-row" id="set-row" style="display:none;">
                            <span class="event-label" data-i18n="hudSetBonus">Bonus de Set:</span>
                            <span class="event-name" id="set-name">---</span>
                        </div>
                    </div>
                    <div class="objectives-panel" id="objectives-panel">
                        <div class="panel-header" data-i18n="hudObjectives">OBJETIVOS</div>
                        <div class="objectives-list" id="objectives-list"></div>
                    </div>
                    <div class="objectives-panel synergies-panel hidden" id="synergies-panel">
                        <div class="panel-header" data-i18n="hudSynergies">SINERGIAS</div>
                        <div class="synergies-list" id="synergies-list"></div>
                    </div>
                </div>
                <div class="hud-section top-right">
                    <div class="stat-pill gold" id="gold-display">üí∞ 0</div>
                </div>
                <div class="hud-section bottom-center">
                    <div class="runes-container" id="runes-display"></div>
                    <div class="skills-container">
                        <div class="skill-slot" id="dash-slot">
                            <div class="skill-icon">üëü</div>
                            <div class="cooldown-overlay" id="dash-cooldown-fill"></div>
                            <span class="key-hint">SPACE</span>
                        </div>
                        <div class="skill-slot" id="active-slot-0">
                            <div class="skill-icon empty"></div>
                            <div class="cooldown-overlay"></div>
                            <span class="key-hint">F</span>
                        </div>
                        <div class="skill-slot locked" id="active-slot-1">
                            <span class="key-hint">G</span>
                        </div>
                        <div class="potion-slot" id="potion-slot">
                            <span class="potion-icon">üß™</span>
                            <span class="potion-count">x3</span>
                            <span class="key-hint">Q</span>
                        </div>
                    </div>
                </div>
                <div class="hud-section right-panel">
                    <div class="items-panel" id="items-panel">
                        <div class="panel-header" data-i18n="hudItems">ITEMS</div>
                        <div class="items-list" id="items-list"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="room-mini" class="room-mini"></div>
        <div id="minimap">
            <canvas id="minimap-canvas" width="150" height="100"></canvas>
            <div id="minimap-legend" class="minimap-legend">
                <div class="legend-item"><span class="legend-dot completed"></span><span data-i18n="mapCompleted">Completadas</span></div>
                <div class="legend-item"><span class="legend-dot incomplete"></span><span data-i18n="mapIncomplete">Incompletas</span></div>
                <div class="legend-item"><span class="legend-dot shop"></span><span data-i18n="mapShop">Tienda</span></div>
                <div class="legend-item"><span class="legend-dot miniboss"></span><span data-i18n="mapMiniboss">MiniBoss</span></div>
                <div class="legend-item"><span class="legend-dot boss"></span><span data-i18n="mapBoss">Boss</span></div>
            </div>
        </div>
    </div>

    <!-- Pause Menu -->
    <div id="pause-menu" class="overlay hidden">
        <div class="pause-content">
            <h2 data-i18n="pauseTitle">‚è∏ PAUSA</h2>
            <div class="pause-buttons">
                <button class="menu-btn" id="btn-resume" data-i18n="btnResume">‚ñ∂ CONTINUAR</button>
                <button class="menu-btn" id="btn-stats" data-i18n="btnStats">üìä ESTAD√çSTICAS</button>
                <button class="menu-btn" id="btn-codex" data-i18n="btnCodex">üìú C√ìDEX</button>
                <button class="menu-btn" id="btn-pause-settings" data-i18n="btnPauseSettings">‚öô AJUSTES</button>
                <button class="menu-btn danger" id="btn-abandon" data-i18n="btnAbandon">üíÄ ABANDONAR RUN</button>
            </div>
        </div>
    </div>

    <!-- Load all game scripts -->
    <script src="js/utils.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/sprites.js"></script>
    <script src="js/entity.js"></script>
    <script src="js/floating_texts.js"></script>
    <script src="js/particles.js"></script>
    <script src="js/projectiles.js"></script>
    <script src="js/runes.js"></script>
    <script src="js/rune_script.js"></script>
    <script src="js/synergies.js"></script>
    <script src="js/items.js"></script>
    <script src="js/enemies.js"></script>
    <script src="js/boss.js"></script>
    <script src="js/player.js"></script>
    <script src="js/biomes.js"></script>
    <script src="js/dungeon.js"></script>
    <script src="js/room.js"></script>
    <script src="js/save.js"></script>
    <script src="js/meta.js"></script>
    <script src="js/input.js"></script>
    <script src="js/ui.js?v=13"></script>
    <script src="js/game.js"></script>
    <script src="js/main.js"></script>

    <!-- Translation System Initializer -->
    <script>
        // Auto-translate DOM elements with data-i18n attributes
        function translateDOM() {
            const lang = window.i18n.getCurrentLang();
            document.getElementById('html-root').lang = lang;
            
            // Translate elements with data-i18n
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                el.textContent = window.i18n.t(key);
            });
            
            // Translate elements with data-i18n-html (preserves HTML)
            document.querySelectorAll('[data-i18n-html]').forEach(el => {
                const key = el.getAttribute('data-i18n-html');
                el.innerHTML = window.i18n.t(key);
            });
            
            // Translate placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                el.placeholder = window.i18n.t(key);
            });
        }
        
        // Language selector functionality
        document.addEventListener('DOMContentLoaded', () => {
            translateDOM();
            
            // Language buttons
            const langButtons = document.querySelectorAll('.language-btn');
            langButtons.forEach(btn => {
                const lang = btn.getAttribute('data-lang');
                if (lang === window.i18n.getCurrentLang()) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
                
                btn.addEventListener('click', () => {
                    const newLang = btn.getAttribute('data-lang');
                    if (newLang !== window.i18n.getCurrentLang()) {
                        window.i18n.setLanguage(newLang);
                        location.reload(); // Reload to apply translations
                    }
                });
            });
        });
    </script>
</body>

</html>
